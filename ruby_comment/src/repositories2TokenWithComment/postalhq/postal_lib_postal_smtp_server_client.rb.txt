UNK on_op data on_period UNK on_lparen on_regexp_beg on_tstring_content on_regexp_end on_comma on_tstring_beg on_tstring_end on_rparen on_nl else on_ignored_nl UNK on_op data on_nl # Discard AUTH= parameter and anything that follows. # We don't need this parameter as we don't trust any client to set it
on_ivar on_op on_symbeg rcpt_to_received on_nl if server on_op on_op on_const on_period where on_lparen on_symbeg UNK on_op uname on_rparen on_period UNK # This is a return path
on_ivar on_op on_symbeg rcpt_to_received on_nl if route on_op on_const on_period where on_lparen on_symbeg UNK on_op uname on_rparen on_period UNK on_nl # This is an email direct to a route. This isn't actually supported yet.
on_ivar on_op on_symbeg rcpt_to_received on_nl if on_ivar on_period server on_period UNK on_nl on_tstring_beg on_tstring_content on_tstring_end on_nl else on_ignored_nl log on_tstring_beg # This is outgoing mail for an authenticated user
on_ivar on_op on_symbeg rcpt_to_received on_nl if route on_period server on_period UNK on_nl on_tstring_beg on_tstring_content on_tstring_end on_nl elsif route on_period UNK # This is incoming mail for a route
on_tstring_beg on_tstring_content on_tstring_end on_nl end on_nl end on_nl on_ignored_nl def data on_lparen data on_rparen on_ignored_nl UNK UNK on_lparen on_symbeg rcpt_to_received # This is unaccepted mail
else on_ignored_nl log on_tstring_beg on_tstring_content on_tstring_end on_nl on_ivar on_op false on_nl end on_nl on_ignored_nl if on_ivar on_nl if data on_period # We want to log if enabled
if on_ivar on_op on_ivar on_lbracket on_ivar on_period downcase on_rbracket on_op on_ivar on_lbracket on_ivar on_period downcase on_rbracket on_period UNK on_nl on_ivar # This is a continuation of a header
UNK if on_const on_period config on_period smtp_server on_period UNK on_op on_ivar on_op on_ivar on_period downcase on_op on_tstring_beg on_tstring_content on_tstring_end on_nl # If received headers are configured to be stripped and we're currently receiving one # skip the append methods at the bottom of this loop.
UNK if on_const on_period config on_period smtp_server on_period UNK on_op on_ivar on_op on_ivar on_period downcase on_op on_tstring_beg on_tstring_content on_tstring_end on_nl # As above
message on_op server on_period UNK on_period UNK on_nl message on_period rcpt_to on_op rcpt_to on_nl message on_period mail_from on_op on_ivar on_nl # Outgoing messages are just inserted
UNK on_period UNK do on_op message on_op on_ignored_nl message on_period rcpt_to on_op rcpt_to on_nl message on_period mail_from on_op on_ivar on_nl # If there's a return path route, we can use this to create the message
message on_op server on_period UNK on_period UNK on_nl message on_period rcpt_to on_op rcpt_to on_nl message on_period mail_from on_op on_ivar on_nl # There's no return path route, we just need to insert the mesage # without going through the route.
