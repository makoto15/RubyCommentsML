on_ivar on_op nil on_nl on_ivar on_op nil on_nl on_ivar on_op false on_nl on_ivar on_op nil on_nl on_ivar on_op nil on_nl # prevent Ruby warnings
on_lparen on_ivar on_lbracket UNK on_period searchkick_index on_period name on_rbracket on_op on_lbracket on_rbracket on_rparen on_op UNK on_nl end on_nl end on_nl # there can be multiple models per index name due to inheritance - see #1259
UNK on_lparen e on_rparen on_nl end on_nl UNK on_lparen response on_rparen on_nl end on_nl end on_nl on_ignored_nl def UNK on_nl # TODO rescue type
host on_op on_const on_period UNK on_period UNK on_period UNK on_period first on_nl UNK on_op host on_lbracket on_symbeg UNK on_rbracket on_op # no easy way to tell which host the client will use
UNK on_tstring_beg on_tstring_content on_tstring_end on_nl on_ignored_nl puts on_tstring_beg on_tstring_content on_embexpr_beg on_const on_op on_const on_embexpr_end on_tstring_end on_nl puts on_tstring_beg on_tstring_content on_embexpr_beg # can remove when minimum Ruby version is 2.5
on_ivar on_op on_const on_op on_const on_period UNK on_lparen searchkick_klass on_comma response on_comma UNK on_rparen on_nl end on_nl on_ignored_nl def UNK # set execute for multi search
page on_op on_lbracket options on_lbracket on_symbeg page on_rbracket on_period UNK on_comma on_int on_rbracket on_period UNK on_nl UNK on_op searchkick_options on_lbracket # pagination
UNK on_op searchkick_options on_lbracket on_symbeg UNK on_rbracket on_op on_int on_op on_int on_nl per_page on_op on_lparen options on_lbracket on_symbeg limit on_rbracket # maybe use index.max_result_window in the future
load on_op options on_lbracket on_symbeg load on_rbracket on_period UNK on_op true on_op options on_lbracket on_symbeg load on_rbracket on_nl on_ignored_nl all # model and eager loading
unless UNK on_tstring_content on_words_sep on_tstring_content on_words_sep on_tstring_content on_words_sep on_tstring_content on_words_sep on_tstring_content on_tstring_end on_period include? on_lparen searchkick_options on_lbracket on_symbeg UNK on_rbracket # searchkick_search and searchkick_search2 are the same for ukrainian
if field on_op on_regexp_beg on_tstring_content on_regexp_end on_op searchkick_options on_lbracket on_symbeg UNK on_rbracket on_op false on_nl UNK on_op on_lbrace on_ignored_nl on_label # boost exact matches more
if all on_nl query on_op on_lbrace on_ignored_nl on_label on_lbrace on_rbrace on_nl on_rbrace on_nl on_ignored_nl should on_op on_lbracket on_rbracket on_nl else # all + exclude option
payload on_op on_lbrace on_ignored_nl on_label on_lbrace on_ignored_nl on_label UNK on_period map on_lbrace on_op qs on_op on_lbrace on_label on_lbrace on_label qs # higher score for matching more fields
where on_op on_lparen options on_lbracket on_symbeg where on_rbracket on_op on_lbrace on_rbrace on_rparen on_period UNK on_nl if searchkick_options on_lbracket on_symbeg UNK # type when inheritance
if UNK on_nl on_const on_period UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl else on_ignored_nl UNK on_op on_ignored_nl models on_period map # aliases are not supported with _index in ES below 7.5 # see https://github.com/elastic/elasticsearch/pull/46640
filters on_op where_filters on_lparen where on_rparen on_nl post_filters on_op on_lbracket on_rbracket on_nl on_ignored_nl UNK on_lparen payload on_comma filters on_comma post_filters # start everything as efficient filters # move to post_filters as aggs demand
UNK on_lparen payload on_comma filters on_comma post_filters on_rparen if options on_lbracket on_symbeg aggs on_rbracket on_nl on_ignored_nl UNK on_lparen payload on_comma # aggregations
UNK on_lparen payload on_comma post_filters on_rparen if post_filters on_period any? on_nl on_ignored_nl custom_filters on_op on_lbracket on_rbracket on_nl multiply_filters on_op on_lbracket # post filters
UNK on_lparen payload on_rparen if options on_lbracket on_symbeg order on_rbracket on_nl on_ignored_nl UNK on_lparen payload on_rparen on_nl on_ignored_nl UNK on_lparen # order
UNK on_lparen payload on_rparen on_nl on_ignored_nl UNK on_lparen payload on_comma options on_lbracket on_symbeg suggest on_rbracket on_rparen if options on_lbracket on_symbeg # indices_boost
UNK on_lparen payload on_comma options on_lbracket on_symbeg suggest on_rbracket on_rparen if options on_lbracket on_symbeg suggest on_rbracket on_nl on_ignored_nl UNK on_lparen # suggestions
UNK on_lparen payload on_comma fields on_rparen if options on_lbracket on_symbeg highlight on_rbracket on_nl on_ignored_nl payload on_lbracket on_symbeg UNK on_rbracket on_op # highlight
payload on_lbracket on_symbeg UNK on_rbracket on_op on_tstring_beg on_embexpr_beg on_const on_period UNK on_op on_int on_embexpr_end on_tstring_content on_tstring_end on_nl on_ignored_nl if options # timeout shortly after client times out
if options on_lbracket on_symbeg UNK on_rbracket on_nl if options on_lbracket on_symbeg UNK on_rbracket on_op on_lbracket on_rbracket on_nl payload on_lbracket on_symbeg # An empty array will cause only the _id and _type for each hit to be returned # https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-source-filtering.html
payload on_lbracket on_symbeg UNK on_rbracket on_op false on_nl else on_ignored_nl payload on_lbracket on_symbeg UNK on_rbracket on_op options on_lbracket on_symbeg UNK # intuitively [] makes sense to return no fields, but ES by default returns all fields
UNK on_op options on_lbracket on_symbeg page on_rbracket on_op options on_lbracket on_symbeg limit on_rbracket on_op options on_lbracket on_symbeg per_page on_rbracket on_op # pagination
if on_op searchkick_options on_lbracket on_symbeg UNK on_rbracket on_op on_lparen options on_lbracket on_symbeg type on_rbracket on_op on_lparen klass on_op searchkick_klass on_op # type
on_ivar on_op options on_lbracket on_symbeg UNK on_rbracket if options on_lbracket on_symbeg UNK on_rbracket on_nl on_ignored_nl if UNK on_nl payload on_lbracket # routing
payload on_op payload on_period UNK on_lparen options on_lbracket on_symbeg body_options on_rbracket on_rparen if options on_lbracket on_symbeg body_options on_rbracket on_nl on_ignored_nl # merge more body options
options on_lbracket on_symbeg UNK on_rbracket on_period UNK on_lparen payload on_rparen if options on_lbracket on_symbeg UNK on_rbracket on_nl on_ignored_nl if options # run block
if options on_lbracket on_symbeg scroll on_rbracket on_op payload on_lbracket on_symbeg query on_rbracket on_op on_lbrace on_label on_lbrace on_rbrace on_rbrace on_nl payload # scroll optimization when interating over all docs # https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-scroll.html
UNK on_lbracket on_symbeg must_not on_rbracket on_op must_not if must_not on_period any? UNK on_lbracket on_symbeg should on_rbracket on_op should if should # where
UNK on_lbracket on_symbeg should on_rbracket on_op should if should on_period any? query on_op on_lbrace on_label UNK on_rbrace on_nl end on_nl # exclude
query on_op on_lbrace on_label UNK on_rbrace on_nl end on_nl on_ignored_nl if custom_filters on_period any? on_nl query on_op on_lbrace on_ignored_nl on_label # conversions
if boost_by_distance on_lbracket on_symbeg field on_rbracket on_nl boost_by_distance on_op on_lbrace boost_by_distance on_lbracket on_symbeg field on_rbracket on_op boost_by_distance on_period except on_lparen # legacy format
if options on_lbracket on_symbeg fields on_rbracket on_nl suggest_fields on_op options on_lbracket on_symbeg fields on_rbracket on_period map on_lbrace on_op v on_op # intersection
aggs on_period each do on_op field on_comma agg_options on_op on_ignored_nl UNK on_op agg_options on_lbracket on_symbeg limit on_rbracket on_op agg_options on_lbracket # convert to more advanced syntax
filters on_period UNK do on_op UNK on_op on_ignored_nl if UNK on_period include? on_lparen UNK on_rparen on_nl true on_nl else on_ignored_nl # only do one level comparison for simplicity
def UNK on_lparen payload on_rparen on_ignored_nl order on_op options on_lbracket on_symbeg order on_rbracket on_period is_a? on_lparen on_const on_rparen on_op options # TODO id transformation for arrays
on_ignored_nl filters on_op on_lbracket on_rbracket on_nl on_lparen where on_op on_lbrace on_rbrace on_rparen on_period each do on_op field on_comma value on_op # if where.respond_to?(:permitted?) && !where.permitted? # # TODO check in more places # Searchkick.warn("Passing unpermitted parameters will raise an exception in Searchkick 5") # end
else on_ignored_nl if value on_period is_a? on_lparen on_const on_rparen on_nl if value on_period end on_period UNK on_op on_lparen value on_period # elsif field == :_script # filters << {script: {script: {source: value, lang: "painless"}}}
if value on_period is_a? on_lparen on_const on_rparen on_nl if value on_period end on_period UNK on_op on_lparen value on_period end on_period # expand ranges
if value on_period end on_period UNK on_op on_lparen value on_period end on_period UNK on_lparen on_symbeg UNK on_rparen on_op value on_period # infinite? added in Ruby 2.4
when on_symbeg UNK on_nl filters on_op on_lbrace on_ignored_nl on_label on_lbrace on_ignored_nl field on_op location_value on_lparen op_value on_rparen on_comma on_ignored_nl on_label # do nothing
UNK on_op UNK on_tstring_content on_words_sep on_tstring_content on_words_sep on_tstring_content on_words_sep on_tstring_content on_words_sep on_tstring_content on_words_sep on_tstring_content on_words_sep on_tstring_content on_words_sep on_tstring_content on_words_sep on_tstring_content # based on Postgres # https://www.postgresql.org/docs/current/functions-matching.html # % matches zero or more characters # _ matches one character # \ is escape character # escape Lucene reserved characters # https://www.elastic.co/guide/en/elasticsearch/reference/current/regexp-syntax.html#regexp-optional-operators
filters on_op on_lbrace on_label on_lbrace field on_op on_lbrace on_label op_value on_rbrace on_rbrace on_rbrace on_nl when on_symbeg UNK on_comma on_symbeg UNK # support for regexp queries without using a regexp ruby object
filters on_op on_lbrace on_label on_lbrace on_label term_filters on_lparen field on_comma op_value on_rparen on_rbrace on_rbrace on_nl when on_symbeg all on_nl op_value # not equal
if on_lparen UNK on_op filters on_period UNK on_lbrace on_op f on_op f on_lbracket on_symbeg UNK on_rbracket on_op f on_lbracket on_symbeg # issue 132
if value on_period any? on_lparen on_op on_symbeg UNK on_rparen on_nl on_lbrace on_label on_lbrace on_label on_lbracket term_filters on_lparen field on_comma nil # in query
on_const on_period UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl end on_nl on_ignored_nl if source on_period UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end # https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-regexp-query.html
if source on_period UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl source on_op source on_lbracket on_int on_op on_op on_int on_rbracket on_nl # TODO handle other anchor characters, like ^, $, \Z
end on_nl on_ignored_nl if source on_period UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl source on_op source on_lbracket on_int on_op on_op # TODO uncomment in Searchkick 5 # source = ".*#{source}"
end on_nl on_ignored_nl on_lbrace on_label on_lbrace field on_op on_lbrace on_label source on_comma on_label on_tstring_beg on_tstring_content on_tstring_end on_rbrace on_rbrace on_rbrace on_nl # TODO uncomment in Searchkick 5 # source = "#{source}.*"
if value on_period UNK on_period is_a? on_lparen on_const on_rparen on_nl raise on_const on_op on_const on_comma on_tstring_beg on_tstring_content on_embexpr_beg value on_period # TODO add this for other values
raise on_const on_op on_const on_comma on_tstring_beg on_tstring_content on_embexpr_beg value on_period UNK on_period name on_embexpr_end on_tstring_end on_nl end on_nl on_ignored_nl on_lbrace # query will fail, but this is better # same message as Active Record # TODO make TypeError # raise InvalidQueryError for backward compatibility
def UNK on_lparen value on_rparen on_ignored_nl if value on_period is_a? on_lparen on_const on_rparen on_nl on_lbracket value on_lbracket on_symbeg UNK on_rbracket # Recursively descend through nesting of arrays until we reach either a lat/lon object or an array of numbers, # eventually returning the same structure with all values transformed to [lon, lat]. #
