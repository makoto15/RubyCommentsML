UNK empty_execution_log_file on_lparen UNK on_comma UNK on_rparen on_ignored_nl UNK on_lparen UNK on_comma UNK on_comma on_tstring_beg on_tstring_end on_rparen on_nl on on_lparen # create the file and make sure its empty and accessible by everyone
UNK on_op UNK on_nl on_tstring_content on_embexpr_beg agent_to_fqdn on_lparen master on_rparen on_embexpr_end on_tstring_content on_embexpr_beg execution_log on_lbracket agent_to_fqdn on_lparen master on_rparen on_rbracket # create a custom type that will write out to a different file on each agent # this way we can verify whether the newtype code was executed on each system
agents on_period each do on_op agent on_op on_ignored_nl UNK on_lparen master on_comma UNK UNK on_rparen do on_ignored_nl on_ignored_nl empty_execution_log_file on_lparen # when the agent does its run, the newtype is executed on both the agent and master nodes # so we should see a message in the execution log file on the agent and the master
UNK on_tstring_beg on_tstring_content on_tstring_end do on_ignored_nl empty_execution_log_file on_lparen master on_comma execution_log on_lbracket agent_to_fqdn on_lparen master on_rparen on_rbracket on_rparen on_nl agents # when generating the pcore the newtype should only be run on the master node
empty_execution_log_file on_lparen master on_comma execution_log on_lbracket agent_to_fqdn on_lparen master on_rparen on_rbracket on_rparen on_nl agents on_period each do on_op agent on_op # start with an empty execution log
on on_lparen master on_comma on_tstring_beg on_tstring_content on_embexpr_beg execution_log on_lbracket agent_to_fqdn on_lparen master on_rparen on_rbracket on_embexpr_end on_tstring_content on_tstring_end on_rparen do on_op # we should see a log entry on the master node
agents on_period each do on_op agent on_op on_ignored_nl UNK UNK agent on_op master on_nl on on_lparen agent on_comma on_tstring_beg on_tstring_content # we should not see any log entries on any of the agent nodes
UNK on_lparen master on_comma UNK UNK on_rparen do on_ignored_nl on on_lparen agent on_comma UNK on_lparen on_tstring_beg on_tstring_content on_embexpr_beg tmp_environment on_embexpr_end # this test is relying on the beaker helper with_puppet_running_on() to restart the server # Compilation should now work using the generated types, # so we should only see a log entry on the agent node and nothing on the master node
