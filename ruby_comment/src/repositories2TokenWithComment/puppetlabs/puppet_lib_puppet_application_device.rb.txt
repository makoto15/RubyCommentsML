on_const on_period UNK on_lparen on_symbeg on_const on_rparen do on_ignored_nl UNK on_period UNK _ on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl exit # Do an initial trap, so that cancels don't get a stack trace.
require on_tstring_beg on_tstring_content on_tstring_end on_nl UNK on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK on_period UNK on_nl if # find device list
UNK on_ignored_nl device_url on_op on_const on_period UNK on_lparen device on_period UNK on_rparen on_nl scheme on_op on_tstring_beg on_embexpr_beg device_url on_period scheme # TODO when we drop support for ruby < 2.5 we can remove the extra block here
scheme on_op on_tstring_beg on_embexpr_beg device_url on_period scheme on_embexpr_end on_tstring_content on_tstring_end if device_url on_period scheme on_nl port on_op on_tstring_beg on_tstring_content on_embexpr_beg # Handle nil scheme & port
on_const on_lbracket on_symbeg ssldir on_rbracket on_op on_op on_const on_period join on_lparen on_const on_lbracket on_symbeg UNK on_rbracket on_comma device on_period name # override local $vardir and $certname
on_const on_op on_const on_period UNK on_lparen on_const on_lbracket on_symbeg ssldir on_rbracket on_rparen unless on_const on_op on_const on_period UNK on_lparen on_const # create device directory under $deviceconfdir
on_const on_period UNK on_period UNK on_symbeg UNK on_comma on_symbeg UNK on_comma on_symbeg UNK on_nl on_ignored_nl UNK on_op on_const on_period join # this will reload and recompute default settings and create device-specific sub vardir
UNK on_op on_const on_period join on_lparen on_const on_lbracket on_symbeg confdir on_rbracket on_comma on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl on_const on_op on_const # Workaround for PUP-8736: store ssl certs outside the cache directory to prevent accidental removal and keep the old path as symlink
if on_const on_period UNK on_period UNK on_op on_op on_const on_op on_const on_op on_const on_period UNK on_nl user on_op on_const on_op # Since it's too complicated to fix properly in the default settings, we workaround for PUP-9642 here. # See https://github.com/puppetlabs/puppet/pull/7483#issuecomment-483455997 for details. # This has to happen after `settings.use` above, so the directory is created and before `setup_host` below, where the SSL # routines would fail with access errors
on_const on_op on_const on_op on_const on_period UNK on_lparen device on_rparen on_nl on_ignored_nl if options on_lbracket on_symbeg resource on_rbracket on_nl type # this inits the device singleton, so that the facts terminus # and the various network_device provider can use it
UNK on_period name on_op UNK on_period UNK on_lbracket on_tstring_beg on_tstring_content on_tstring_end on_rbracket on_nl UNK on_op on_const on_op on_const on_op on_const # Give a proper name to the facts
on_const on_op on_const on_op on_const on_period indirection on_period UNK on_op on_symbeg UNK on_nl on_const on_op on_const on_op on_const on_period indirection # avoid reporting to server
on_int on_nl UNK on_ignored_nl UNK on_period UNK on_nl on_const on_lbracket on_symbeg libdir on_rbracket on_op libdir on_nl on_const on_lbracket on_symbeg UNK # If we rescued an error, then we return 1 as the exit code
exit on_lparen UNK on_period UNK on_period UNK on_lparen on_symbeg on_op on_rparen on_rparen on_nl UNK UNK on_period UNK on_int on_nl exit # Bitwise OR the return codes together, puppet style
on_const on_period UNK on_period UNK on_symbeg UNK on_comma on_symbeg UNK on_comma on_symbeg device on_comma on_symbeg UNK on_nl on_ignored_nl if options # setup global device-specific defaults; creates all necessary directories, etc
