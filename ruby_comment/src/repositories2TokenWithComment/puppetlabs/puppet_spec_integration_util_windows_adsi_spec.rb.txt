expect on_lbrace UNK on_period UNK on_rbrace on_period to UNK on_lparen UNK on_tstring_content UNK on_rparen on_nl end on_nl end on_nl on_ignored_nl # trying to retrieve COM object should fail to load with a localized version of: # ADSI connection error: failed to parse display name of moniker `WinNT://./SYSTEM,user' # HRESULT error code:0x800708ad # The user name could not be found. # Matching on error code alone is sufficient
on_ignored_nl on_const on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK do on_op user on_op on_ignored_nl expect on_lparen user # Western Europe
on_ignored_nl on_ignored_nl UNK on_op on_const on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen # Western Europe
UNK on_op on_const on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl UNK # lookup by English name Administrator is OK on localized Windows
on_ignored_nl on_const on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK do on_op group on_op on_ignored_nl expect on_lparen group # Western Europe
UNK on_op on_tstring_beg on_tstring_content on_tstring_content on_tstring_end on_nl UNK on_op on_tstring_beg on_tstring_content UNK on_const on_period UNK on_lbracket on_int on_op on_int on_rbracket # From https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/password-must-meet-complexity-requirements
UNK on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl on_ignored_nl UNK on_op # select a virtual account that requires an authority to be able to resolve to SID # the Dhcp service is chosen for no particular reason aside from it's a service available on all Windows versions
UNK on_op on_lbracket on_ignored_nl on_lbrace on_symbeg sid on_op on_tstring_beg on_tstring_content on_tstring_end on_comma on_symbeg name on_op on_const on_op on_const on_op on_const # adding :SidTypeGroup as a group member will cause error in IAdsUser::Add # adding :SidTypeDomain (such as S-1-5-80 / NT SERVICE or computer name) won't error # but also won't be returned as a group member # uncertain how to obtain :SidTypeComputer (perhaps AD? the local machine is :SidTypeDomain)
on_lbrace on_symbeg sid on_op on_tstring_beg on_tstring_content on_tstring_end on_comma on_symbeg name on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK # Use sid_to_name to get localized names of SIDs - BUILTIN, SYSTEM, NT AUTHORITY, Everyone are all localized # :SidTypeWellKnownGroup # SYSTEM is prefixed with the NT Authority authority, resolveable with or without authority
on_lbrace on_symbeg sid on_op on_tstring_beg on_tstring_content on_tstring_end on_comma on_symbeg name on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK # Everyone is not prefixed with an authority, resolveable with or without NT AUTHORITY authority
on_lbrace on_symbeg sid on_op UNK on_period sid on_comma on_symbeg name on_op UNK on_period UNK on_rbrace on_comma on_ignored_nl on_ignored_nl on_lbrace on_symbeg # Dhcp service account is prefixed with NT SERVICE authority, requires authority to resolve SID # behavior is similar to IIS APPPOOL\DefaultAppPool
on_lbrace on_symbeg sid on_op on_tstring_beg on_tstring_content on_tstring_end on_comma on_symbeg name on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK # :SidTypeAlias with authority component # Administrators group is prefixed with BUILTIN authority, can be resolved with or without authority
user on_op on_const on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK on_lparen UNK on_rparen on_nl user on_period UNK # :SidTypeUser as user on localhost, can be resolved with or without authority prefix
user on_period UNK on_op UNK on_nl user on_period UNK on_lparen on_rparen on_nl UNK on_period UNK on_lparen on_lbrace on_symbeg sid on_op # appveyor sometimes requires a password
group on_op UNK on_period UNK on_lparen UNK on_rparen on_nl group on_period UNK on_lparen on_rparen on_nl group on_period UNK on_lparen UNK # create a test group and add above 5 members by SID
expect on_lbrace UNK on_period UNK on_lparen group on_period members on_rparen on_rbrace on_period UNK UNK on_nl on_ignored_nl UNK on_op UNK on_period # most importantly make sure that all name are convertible to SIDs
UNK on_op UNK on_period UNK on_lbrace on_op UNK on_op UNK on_lbracket on_symbeg name on_rbracket on_rbrace on_nl expect on_lparen group on_period # also verify the names returned are as expected
UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_comma on_lbrace on_ignored_nl on_symbeg UNK on_op on_lbracket on_int on_comma on_int on_comma on_int on_comma on_int on_comma # NULL SID is not localized
UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_comma on_lbrace on_ignored_nl on_symbeg UNK on_op on_lbracket on_int on_comma on_int on_comma on_int on_comma on_int on_comma # unresolvable SID is a different story altogether
on_symbeg UNK on_op on_lbracket on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma # completely valid SID, but Name is just a stringified version
admins on_period UNK on_nl UNK on_lparen admins on_period UNK on_rparen on_period to UNK on_lparen on_symbeg on_const on_rparen on_period UNK on_lparen # touch the native_object member to have it lazily loaded, so COM objects can be stubbed
expect on_lparen admins on_period members on_lbracket on_int on_rbracket on_period sid on_rparen on_period to eq on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl # well-known NULL SID
expect on_lparen admins on_period members on_lbracket on_int on_rbracket on_period sid on_rparen on_period to eq on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl # unresolvable SID
on_ignored_nl admins on_op on_const on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK on_lparen UNK on_period UNK on_rparen on_nl # Western Europe
admins on_op on_const on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK on_lparen UNK on_period UNK on_rparen on_nl admins # lookup by English name Administrators is not OK on localized Windows
