let on_lparen on_symbeg builtin_localized on_rparen on_lbrace on_const on_op on_const on_op on_const on_op on_const on_period UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen # BUILTIN is localized on German Windows, but not French # looking this up like this dilutes the values of the tests as we're comparing two mechanisms # for returning the same values, rather than to a known good
principal on_op on_const on_op on_const on_op on_const on_op on_const on_op on_const on_period lookup_account_name on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl expect # a special case that can be used to lookup an account on a localized Windows
UNK on_op on_int on_nl UNK on_lparen on_const on_op on_const on_op on_const on_op on_const on_period UNK on_op UNK on_op UNK on_rparen # guard these 3 checks on a US Windows with 1033 - primary language id of 9
UNK on_lparen on_const on_op on_const on_op on_const on_op on_const on_period UNK on_op UNK on_op UNK on_rparen on_nl expect on_lparen principal # even though lookup in English, returned values may be localized # French Windows returns AUTORITE NT\\Syst\u00E8me, German Windows returns NT-AUTORIT\u00C4T\\SYSTEM
UNK UNK on_period sid_bytes on_op UNK on_nl account_type on_op on_symbeg on_const on_nl UNK on_ignored_nl account_type on_op on_symbeg on_const on_nl end # Windows API LookupAccountSid behaves differently if current user is SYSTEM
on_const on_op on_const on_op on_const on_op on_const on_period UNK on_lparen UNK on_period sid on_op on_tstring_beg on_tstring_content on_tstring_end on_rparen on_period UNK # need to return localized name of Administrator account
UNK UNK on_lparen UNK on_op on_op UNK on_rparen on_nl on_ignored_nl UNK on_op on_const on_op on_const on_op on_const on_op on_const on_period # when running as SYSTEM (in Jenkins CI), then Administrator should be used # otherwise running in AppVeyor there is no Administrator and a the current local user can be used
expect on_lparen principal on_period domain on_rparen on_period to UNK on_lparen on_regexp_beg on_tstring_content on_embexpr_beg on_const on_period UNK on_lparen UNK on_rparen on_embexpr_end # skip SID and bytes in this case since the most interesting thing here is domain_account
qualified_name on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl domain on_comma name # by looking up the localized name of the account, the test value is diluted # this localizes Administrators AND BUILTIN
end on_nl end on_nl on_ignored_nl it on_tstring_beg on_tstring_content on_tstring_end do on_ignored_nl principal on_op on_const on_op on_const on_op on_const on_op on_const # ERROR_NONE_MAPPED
UNK on_op on_lparen UNK on_period sid_bytes on_op on_lbracket on_int on_comma on_int on_comma on_int on_comma on_int on_rbracket on_rparen on_nl UNK on_lbracket # take the computer account bytes and append the equivalent of -501 for Guest
UNK on_lbracket on_int on_rbracket on_op on_int on_nl principal on_op on_const on_op on_const on_op on_const on_op on_const on_op on_const on_period lookup_account_sid # computer SID bytes start with [1, 4, ...] but need to be [1, 5, ...]
UNK on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK on_lparen principal on_period sid on_rparen on_nl on_ignored_nl expect on_lparen # use the returned SID to lookup localized Guest account name in Windows
qualified_name on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl domain on_comma name # by looking up the localized name of the account, the test value is diluted # this localizes Administrators AND BUILTIN
it on_tstring_beg on_tstring_content on_tstring_end do on_ignored_nl principal on_op on_const on_op on_const on_op on_const on_op on_const on_op on_const on_nl expect on_lbrace # https://technet.microsoft.com/en-us/library/cc962011.aspx # "... The structure used in all SIDs created by Windows NT and Windows 2000 is revision level 1. ..." # Therefore a value of zero for the revision, is not a valid SID
end on_nl end on_nl on_ignored_nl it on_tstring_beg on_tstring_content on_tstring_end do on_ignored_nl principal on_op on_const on_op on_const on_op on_const on_op on_const # ERROR_INVALID_PARAMETER
principal on_period lookup_account_sid on_lparen on_lbracket on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int # S-1-1-1 which is not a valid account
end on_nl end on_nl on_ignored_nl it on_tstring_beg on_tstring_content on_tstring_end do on_ignored_nl principal on_op on_const on_op on_const on_op on_const on_op on_const # ERROR_NONE_MAPPED
expect on_lparen sid_principal on_rparen on_period to eq on_lparen name_principal on_rparen on_nl on_ignored_nl sid_principal on_period UNK on_lparen UNK on_rparen on_period UNK # compares canonical sid
sid_principal on_period UNK on_lparen UNK on_rparen on_period UNK on_lbrace on_op UNK on_op UNK on_op on_symbeg on_op on_rbrace on_period UNK do # compare all properties that have public accessors
expect on_lparen sid_principal on_rparen on_period to eq on_lparen name_principal on_rparen on_nl on_ignored_nl sid_principal on_period UNK on_lparen UNK on_rparen on_period UNK # compares canonical sid
sid_principal on_period UNK on_lparen UNK on_rparen on_period UNK on_lbrace on_op UNK on_op UNK on_op on_symbeg on_op on_rbrace on_period UNK do # compare all properties that have public accessors
