on_const on_op UNK on_nl on_const on_op UNK on_nl on_ignored_nl on_const on_op on_tstring_beg on_tstring_content on_tstring_end on_nl on_const on_op on_tstring_beg on_tstring_content on_tstring_end # missing from Windows::Error
on_const on_op on_tstring_beg on_tstring_content on_tstring_end on_nl on_const on_op on_tstring_beg on_tstring_content on_tstring_end on_nl on_const on_op on_tstring_beg on_tstring_content on_tstring_end on_nl on_const on_op # Well Known SIDs
def UNK on_lparen name on_rparen on_ignored_nl UNK on_op UNK on_lparen name on_rparen on_nl on_ignored_nl UNK on_op UNK on_period UNK on_op # Convert an account name, e.g. 'Administrators' into a SID string, # e.g. 'S-1-5-32-544'. The name can be specified as 'Administrators', # 'BUILTIN\Administrators', or 'S-1-5-32-544', and will return the # SID. Returns nil if the account doesn't exist.
def UNK on_lparen name on_comma UNK on_op UNK on_rparen on_ignored_nl name on_op name on_period UNK on_period UNK if name on_nl # Convert an account name, e.g. 'Administrators' into a Principal::SID object, # e.g. 'S-1-5-32-544'. The name can be specified as 'Administrators', # 'BUILTIN\Administrators', or 'S-1-5-32-544', and will return the # SID object. Returns nil if the account doesn't exist. # This method returns a SID::Principal with the account, domain, SID, etc
name on_op name on_period UNK on_period UNK if name on_nl on_ignored_nl raw_sid_bytes on_op nil on_nl UNK on_ignored_nl UNK on_lparen name # Apparently, we accept a symbol..
raw_sid_bytes on_op nil on_nl UNK on_ignored_nl UNK on_lparen name on_rparen do on_op sid_ptr on_op on_ignored_nl raw_sid_bytes on_op sid_ptr on_period UNK # if name is a SID string, convert it to raw bytes for use with lookup_account_sid
def UNK on_lparen UNK on_rparen on_ignored_nl if on_op UNK on_op on_op UNK on_period UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_op # Converts an octet string array of bytes to a SID::Principal object, # e.g. [1, 1, 0, 0, 0, 0, 0, 5, 18, 0, 0, 0] is the representation for # S-1-5-18, the local 'SYSTEM' account. # Raises an Error for nil or non-array input. # This method returns a SID::Principal with the account, domain, SID, etc
def UNK on_lparen ads_object on_rparen on_ignored_nl if on_op ads_object on_op on_op ads_object on_period UNK on_lparen on_symbeg UNK on_rparen on_op on_ignored_nl # Converts a COM instance of IAdsUser or IAdsGroup to a SID::Principal object, # Raises an Error for nil or an object without an objectSID / Name property. # This method returns a SID::Principal with the account, domain, SID, etc # This method will return instances even when the SID is unresolvable, as # may be the case when domain users have been added to local groups, but # removed from the domain
raise if e on_period UNK on_op on_const on_nl on_ignored_nl if on_op UNK on_lparen ads_object on_period on_const on_rparen on_op on_ignored_nl on_lparen # if the error is not a lookup / mapping problem, immediately re-raise
if on_op UNK on_lparen ads_object on_period on_const on_rparen on_op on_ignored_nl on_lparen on_lparen UNK on_op UNK on_lparen ads_object on_period UNK on_rparen # if the Name property isn't formatted like a SID, OR
on_lparen on_lparen UNK on_op UNK on_lparen ads_object on_period UNK on_rparen on_rparen on_op ads_object on_period on_const on_rparen on_nl raise on_const on_op # if the objectSID doesn't match the Name property, also raise
def UNK on_lparen UNK on_rparen on_ignored_nl on_ignored_nl sid_bytes on_op UNK UNK on_nl UNK on_ignored_nl UNK on_lparen UNK on_rparen do on_op # Convert a SID string, e.g. "S-1-5-32-544" to a name, # e.g. 'BUILTIN\Administrators'. Returns nil if an account # for that SID does not exist.
on_const on_op UNK on_nl on_ignored_nl def UNK on_lparen UNK on_rparen on_ignored_nl if on_op UNK on_period UNK on_lparen on_const on_op on_const # https://stackoverflow.com/a/1792930 - 68 bytes, 184 characters in a string
def UNK on_lparen UNK on_rparen on_ignored_nl if on_op UNK on_period UNK on_lparen on_const on_op on_const on_rparen on_op on_const on_lparen UNK # Convert a SID pointer to a SID string, e.g. "S-1-5-32-544".
def UNK on_lparen UNK on_comma on_op UNK on_rparen on_ignored_nl on_const on_op on_const on_period UNK on_lparen UNK on_rparen do on_op UNK # Convert a SID string, e.g. "S-1-5-32-544" to a pointer (containing the # address of the binary SID structure). The returned value can be used in # Win32 APIs that expect a PSID, e.g. IsValidSid. The account for this # SID may or may not exist.
nil on_nl end on_nl module_function on_symbeg UNK on_nl on_ignored_nl def UNK on_lparen UNK on_rparen on_ignored_nl UNK on_op UNK on_nl on_ignored_nl # yielded sid_ptr has already had LocalFree called, nothing to return
def UNK on_lparen UNK on_rparen on_ignored_nl UNK on_op UNK on_nl on_ignored_nl UNK on_ignored_nl UNK on_lparen UNK on_rparen UNK on_op ptr # Return true if the string is a valid SID, e.g. "S-1-5-32-544", false otherwise.
if on_op sid_ptr on_period UNK on_lparen on_const on_op on_const on_rparen on_op on_const on_lparen sid_ptr on_rparen on_op on_const on_op on_const on_nl # MSDN states IsValidSid should be called on pointer first
def UNK on_period UNK on_lparen name on_comma sid_bytes on_rparen on_ignored_nl on_const on_period new on_lparen on_ignored_nl name on_comma sid_bytes on_comma name # @api private
sid_bytes on_comma name on_comma nil on_comma on_symbeg on_const on_rparen on_nl end on_nl on_ignored_nl UNK on_symbeg UNK on_nl on_ignored_nl UNK on_symbeg # account
name on_comma nil on_comma on_symbeg on_const on_rparen on_nl end on_nl on_ignored_nl UNK on_symbeg UNK on_nl on_ignored_nl UNK on_symbeg UNK on_nl # sid_bytes
nil on_comma on_symbeg on_const on_rparen on_nl end on_nl on_ignored_nl UNK on_symbeg UNK on_nl on_ignored_nl UNK on_symbeg UNK on_nl UNK on_symbeg # sid string
on_symbeg on_const on_rparen on_nl end on_nl on_ignored_nl UNK on_symbeg UNK on_nl on_ignored_nl UNK on_symbeg UNK on_nl UNK on_symbeg on_const on_comma #domain # https://msdn.microsoft.com/en-us/library/cc245534.aspx?f=255&MSPPError=-2147217396 # Indicates that the type of object could not be determined. For example, no object with that SID exists.
UNK on_symbeg UNK on_nl UNK on_symbeg on_const on_comma on_ignored_nl UNK on_symbeg pointer UNK on_comma on_symbeg UNK on_nl on_ignored_nl UNK on_symbeg # https://msdn.microsoft.com/en-us/library/windows/desktop/aa379151(v=vs.85).aspx # BOOL WINAPI IsValidSid( # _In_ PSID pSid # );
UNK on_symbeg UNK on_nl UNK on_symbeg on_const on_comma on_ignored_nl UNK on_symbeg pointer on_comma on_symbeg pointer UNK on_comma on_symbeg UNK on_nl # https://msdn.microsoft.com/en-us/library/windows/desktop/aa376399(v=vs.85).aspx # BOOL ConvertSidToStringSid( # _In_ PSID Sid, # _Out_ LPTSTR *StringSid # );
UNK on_symbeg UNK on_nl UNK on_symbeg on_const on_comma on_ignored_nl UNK on_symbeg UNK on_comma on_symbeg pointer UNK on_comma on_symbeg UNK on_nl # https://msdn.microsoft.com/en-us/library/windows/desktop/aa376402(v=vs.85).aspx # BOOL WINAPI ConvertStringSidToSid( # _In_ LPCTSTR StringSid, # _Out_ PSID *Sid # );
UNK on_symbeg UNK on_nl UNK on_symbeg on_const on_comma UNK on_symbeg pointer UNK on_comma on_symbeg UNK on_nl end on_nl end on_nl # https://msdn.microsoft.com/en-us/library/windows/desktop/aa446642(v=vs.85).aspx # DWORD WINAPI GetLengthSid( # _In_ PSID pSid # );
