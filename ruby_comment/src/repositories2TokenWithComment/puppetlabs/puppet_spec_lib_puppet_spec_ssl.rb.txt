def self on_period UNK on_nl root_key on_op create_private_key on_nl root_cert on_op UNK on_lparen root_key on_comma on_const on_rparen on_nl UNK on_op # Creates a self-signed root ca, then signs two node certs, revoking one of them. # Creates an intermediate CA and one node cert off of it. # Creates a second intermediate CA and one node cert off if it. # Creates a leaf CA off of the intermediate CA, then signs two node certs revoking one of them. # Revokes an intermediate CA. # Returns the ca bundle, crl chain, and all the node certs # # ----- # / \ # / \ # | root +-------------------o------------------o # \ CA / | | # \ / | | # --+-- | | # | | | # | | | # | | | # | --+-- --+-- # +---------+ | +---------+ / \ / \ # | revoked | | | | /revoked\ / \ # | node +--o---+ node | | int | | int | # | | | | \ CA / \ CA / # +---------+ +---------+ \ / \ / # --+-- --+-- # | | # | | # | | # --+-- | # / \ +---+-----+ # / \ | | # | leaf | | node | # \ CA / | | # \ / +---------+ # --+-- # | # | # +---------+ | +----------+ # | revoked | | | | # | node +--o--+ node | # | | | | # +---------+ +----------+
