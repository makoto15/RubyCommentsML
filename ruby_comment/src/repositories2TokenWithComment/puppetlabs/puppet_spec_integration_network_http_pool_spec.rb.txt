on_const on_lbracket on_symbeg UNK on_rbracket on_op on_tstring_beg on_tstring_content on_tstring_end on_nl end on_nl on_ignored_nl UNK on_lparen on_symbeg hostname on_rparen on_lbrace on_tstring_beg # make sure we don't take too long
UNK on_op UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl on_const on_period UNK on_lparen UNK on_comma cert_fixture on_lparen on_tstring_beg on_tstring_content on_tstring_end # File must exist and by not empty so DefaultValidator doesn't # downgrade to VERIFY_NONE, so use a different CA that didn't # issue the server's cert
UNK UNK on_lparen ctx on_rparen on_ignored_nl ctx on_period UNK on_op on_const on_op on_const on_op on_const on_op on_const on_op on_const on_op # Configure the server's SSLContext to require a client certificate. The `client_ca` # setting allows the server to advertise which client CAs it will accept.
expect on_lparen ssl_context on_period UNK on_period UNK on_lparen on_op on_symbeg UNK on_rparen on_rparen on_period to eq on_lparen on_lbracket pluto on_period # verify client has incomplete chain
UNK on_op UNK on_lparen ctx on_rparen UNK on_ignored_nl UNK on_lparen ctx on_rparen on_nl on_ignored_nl ctx on_period UNK on_period UNK on_lparen # force server to require (not request) client certs
ctx on_period UNK on_period UNK on_lparen cert_fixture on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_rparen on_nl on_rbrace on_nl on_ignored_nl server on_period start_server # server needs to trust the client's intermediate CA to complete the client's chain
expect on_lparen ssl_context on_period UNK on_period UNK on_lparen on_op on_symbeg UNK on_rparen on_rparen on_period to eq on_lparen on_lbracket pluto on_comma # verify client has complete chain from leaf to root
