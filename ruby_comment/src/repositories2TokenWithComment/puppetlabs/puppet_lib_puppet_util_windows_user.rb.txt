UNK on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK on_nl UNK UNK on_op on_const on_op on_const on_op on_const # if Vista or later, check for unrestricted process token
on_const on_op on_int on_nl on_ignored_nl on_const on_op on_int on_nl on_const on_op on_int on_nl on_const on_op on_int on_nl on_const on_op on_int # https://msdn.microsoft.com/en-us/library/windows/desktop/ee207397(v=vs.85).aspx
on_const on_op on_int on_nl on_const on_op on_int on_nl on_const on_op on_int on_nl on_const on_op on_int on_nl on_ignored_nl def UNK on_nl # https://msdn.microsoft.com/en-us/library/windows/desktop/ms681385(v=vs.85).aspx # These error codes indicate successful authentication but failure to # logon for a separate reason
UNK on_op UNK on_period UNK on_nl end on_nl end on_nl on_ignored_nl UNK on_nl end on_nl UNK on_symbeg UNK on_nl on_ignored_nl # Is administrators SID enabled in calling thread's access token?
if UNK on_lparen name on_comma password on_comma UNK on_comma UNK on_comma UNK on_rparen on_op on_const on_op on_const on_nl if UNK #try logon using network else try logon using interactive mode
UNK on_nl end on_nl on_ignored_nl UNK on_symbeg UNK on_nl on_ignored_nl def UNK on_period UNK on_lparen name on_comma password on_comma UNK # token has been closed by this point
pi on_lbracket on_symbeg UNK on_rbracket on_op UNK on_nl on_ignored_nl if on_const on_lparen token on_comma pi on_period pointer on_rparen on_op on_const # PI_NOUI - prevents display of profile error msgs
if on_const on_lparen token on_comma pi on_period pointer on_rparen on_op on_const on_op on_const on_nl raise on_const on_op on_const on_op on_const # Load the profile. Since it doesn't exist, it will be created
ffi_lib on_symbeg UNK on_nl attach_function_private on_symbeg on_const on_comma on_ignored_nl on_lbracket on_symbeg UNK on_comma on_symbeg UNK on_comma on_symbeg UNK on_comma on_symbeg # https://msdn.microsoft.com/en-us/library/windows/desktop/aa378184(v=vs.85).aspx # BOOL LogonUser( # _In_ LPTSTR lpszUsername, # _In_opt_ LPTSTR lpszDomain, # _In_opt_ LPTSTR lpszPassword, # _In_ DWORD dwLogonType, # _In_ DWORD dwLogonProvider, # _Out_ PHANDLE phToken # );
UNK on_const on_op on_const on_op on_const on_nl UNK on_symbeg UNK on_comma on_symbeg UNK on_comma on_ignored_nl on_symbeg UNK on_comma on_symbeg UNK # https://msdn.microsoft.com/en-us/library/windows/desktop/bb773378(v=vs.85).aspx # typedef struct _PROFILEINFO { # DWORD dwSize; # DWORD dwFlags; # LPTSTR lpUserName; # LPTSTR lpProfilePath; # LPTSTR lpDefaultPath; # LPTSTR lpServerName; # LPTSTR lpPolicyPath; # HANDLE hProfile; # } PROFILEINFO, *LPPROFILEINFO; # technically # NOTE: that for structs, buffer_* (lptstr alias) cannot be used
ffi_lib on_symbeg UNK on_nl attach_function_private on_symbeg on_const on_comma on_ignored_nl on_lbracket on_symbeg handle on_comma on_symbeg pointer on_rbracket on_comma on_symbeg win32_bool on_nl # https://msdn.microsoft.com/en-us/library/windows/desktop/bb762281(v=vs.85).aspx # BOOL WINAPI LoadUserProfile( # _In_ HANDLE hToken, # _Inout_ LPPROFILEINFO lpProfileInfo # );
ffi_lib on_symbeg UNK on_nl attach_function_private on_symbeg on_const on_comma on_ignored_nl on_lbracket on_symbeg handle on_comma on_symbeg handle on_rbracket on_comma on_symbeg win32_bool on_nl # https://msdn.microsoft.com/en-us/library/windows/desktop/bb762282(v=vs.85).aspx # BOOL WINAPI UnloadUserProfile( # _In_ HANDLE hToken, # _In_ HANDLE hProfile # );
ffi_lib on_symbeg UNK on_nl attach_function_private on_symbeg on_const on_comma on_ignored_nl on_lbracket on_symbeg handle on_comma on_symbeg pointer on_comma on_symbeg UNK on_rbracket on_comma # https://msdn.microsoft.com/en-us/library/windows/desktop/aa376389(v=vs.85).aspx # BOOL WINAPI CheckTokenMembership( # _In_opt_ HANDLE TokenHandle, # _In_ PSID SidToCheck, # _Out_ PBOOL IsMember # );
on_const on_op UNK on_lparen on_ignored_nl on_symbeg on_const on_comma on_int on_comma on_ignored_nl on_symbeg on_const on_comma on_int on_comma on_ignored_nl on_symbeg on_const on_comma # https://msdn.microsoft.com/en-us/library/windows/desktop/aa379650(v=vs.85).aspx
ffi_lib on_symbeg UNK on_nl attach_function_private on_symbeg on_const on_comma on_ignored_nl on_lbracket on_const on_comma on_symbeg pointer on_comma on_symbeg pointer on_comma on_symbeg UNK # https://msdn.microsoft.com/en-us/library/windows/desktop/aa446585(v=vs.85).aspx # BOOL WINAPI CreateWellKnownSid( # _In_ WELL_KNOWN_SID_TYPE WellKnownSidType, # _In_opt_ PSID DomainSid, # _Out_opt_ PSID pSid, # _Inout_ DWORD *cbSid # );
ffi_lib on_symbeg UNK on_nl attach_function_private on_symbeg on_const on_comma on_ignored_nl on_lbracket on_symbeg pointer on_rbracket on_comma on_symbeg win32_bool on_nl end on_nl EMP # https://msdn.microsoft.com/en-us/library/windows/desktop/aa379151(v=vs.85).aspx # BOOL WINAPI IsValidSid( # _In_ PSID pSid # );
