expect on_lparen converted on_period UNK on_rparen on_period to eq on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl end on_nl on_ignored_nl it on_tstring_beg # carefully select a SID here that is not localized on international Windows
valid_octet_invalid_user on_op on_lbracket on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int # S-1-1-1 which is not a valid account
end on_nl end on_nl on_ignored_nl it on_tstring_beg on_tstring_content on_tstring_end do on_ignored_nl expect on_lbrace on_ignored_nl UNK on_op on_lbracket on_int on_rbracket on_nl # ERROR_NONE_MAPPED
end on_nl end on_nl end on_nl on_ignored_nl context on_tstring_beg on_tstring_content on_tstring_end do on_ignored_nl it on_tstring_beg on_tstring_content on_tstring_end do on_ignored_nl expect # ERROR_INVALID_PARAMETER
expect on_lparen subject on_period name_to_sid on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_rparen on_period to eq on_lparen sid on_rparen on_nl end on_nl # NOTE: lookup by name works in localized environments only for a few instances # this works in French Windows, even though the account is really Syst\u00E8me
expect on_lparen subject on_period name_to_sid on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_rparen on_period to eq on_lparen sid on_rparen on_nl end on_nl # NOTE: lookup by name works in localized environments only for a few instances # this works in French Windows, even though the account is really AUTORITE NT\\Syst\u00E8me
UNK on_op on_const on_op on_const on_op on_const on_op on_const on_period UNK on_lparen UNK on_comma on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl UNK # Ruby seems to use the local codepage when making COM calls # if this fails, might want to use Windows API directly instead to ensure bytes
sid_bytes on_op UNK on_period objectsid on_period UNK on_nl UNK on_op on_tstring_beg on_tstring_end on_nl on_const on_op on_const on_period UNK on_lparen on_symbeg # compare the new SID to the name_to_sid result
expect on_lparen subject on_period name_to_principal on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_period sid on_rparen on_period to eq on_lparen sid on_rparen on_nl # NOTE: lookup by name works in localized environments only for a few instances # this works in French Windows, even though the account is really Syst\u00E8me
expect on_lparen subject on_period name_to_principal on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_rparen on_period to eq on_lparen subject on_period name_to_principal on_lparen on_tstring_beg # NOTE: lookup by name works in localized environments only for a few instances # this works in French Windows, even though the account is really Syst\u00E8me
expect on_lparen subject on_period name_to_principal on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_rparen on_period to eq on_lparen subject on_period name_to_principal on_lparen on_tstring_beg # NOTE: lookup by name works in localized environments only for a few instances # this works in French Windows, even though the account is really Syst\u00E8me
expect on_lparen subject on_period name_to_principal on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_period sid on_rparen on_period to eq on_lparen sid on_rparen on_nl # NOTE: lookup by name works in localized environments only for a few instances # this works in French Windows, even though the account is really AUTORITE NT\\Syst\u00E8me
end on_nl end on_nl on_ignored_nl it on_tstring_beg on_tstring_content on_tstring_end do on_ignored_nl expect on_lbrace on_ignored_nl valid_octet_invalid_user on_op on_lbracket on_int on_comma on_int # ERROR_INVALID_PARAMETER
valid_octet_invalid_user on_op on_lbracket on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int # S-1-1-1 is a valid SID that will not resolve
end on_nl end on_nl on_ignored_nl it on_tstring_beg on_tstring_content on_tstring_end do on_ignored_nl valid_octet_invalid_user on_op on_lbracket on_int on_comma on_int on_comma on_int on_comma # ERROR_NONE_MAPPED
valid_octet_invalid_user on_op on_lbracket on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int on_comma on_int # S-1-1-1 is a valid SID that will not resolve
expect on_lparen converted on_period UNK on_rparen on_period to eq on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl expect on_lparen converted on_period UNK # carefully select a SID here that is not localized on international Windows
expect on_lparen converted on_period UNK on_rparen on_period UNK eq on_lparen UNK on_period on_const on_rparen on_nl end on_nl end on_nl on_ignored_nl # garbage name supplied does not carry forward as SID is looked up again
expect on_lparen subject on_period UNK on_lparen UNK on_rparen on_rparen on_period to eq on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl end on_nl # choose a value that is not localized, for instance # S-1-5-18 can be NT AUTHORITY\\SYSTEM or AUTORITE NT\\Syst\u00E8me # but NULL SID appears universal
