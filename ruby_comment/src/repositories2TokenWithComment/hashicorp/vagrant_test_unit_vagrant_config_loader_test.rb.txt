let on_lparen on_symbeg current_version on_rparen on_lbrace UNK on_period UNK on_rbrace on_nl on_ignored_nl let on_lparen on_symbeg UNK on_rparen do on_ignored_nl on_const # This is the current version of configuration for the tests.
let on_lparen on_symbeg UNK on_rparen do on_ignored_nl on_const on_period new on_lparen on_const on_op on_const on_op on_const on_rparen do on_ignored_nl def # This is just a dummy implementation of a configuration loader which # simply acts on hashes.
on_const on_op on_lbracket on_int on_comma on_int on_rbracket on_period UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_period UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end # This represents the euro symbol in UTF-16LE. pack("c*") returns an ASCII # string and so we have to force the encoding
def UNK on_period UNK on_lparen UNK on_rparen on_ignored_nl UNK on_lbracket on_symbeg UNK on_rbracket on_op true on_nl UNK on_nl end on_nl # Create the finalize method on our loader
proc on_op UNK do on_op config on_op on_ignored_nl config on_lbracket on_symbeg foo on_rbracket on_op on_tstring_beg on_tstring_content on_tstring_end on_nl end on_nl # Basic configuration proc
instance on_period set on_lparen on_symbeg proc on_comma on_lbracket on_lbracket current_version on_comma proc on_rbracket on_rbracket on_rparen on_nl config on_comma UNK on_op # Run the actual configuration and assert that we get the proper result
proc on_op UNK on_lbrace on_op config on_op config on_lbracket on_symbeg foo on_rbracket on_op on_tstring_beg on_tstring_content on_tstring_end on_rbrace on_nl instance on_period # Load a version 1 proc, and verify it is upgraded to version 2
proc on_op UNK on_lbrace on_op config on_op config on_lbracket on_symbeg foo on_rbracket on_op on_tstring_beg on_tstring_content on_tstring_end on_rbrace on_nl instance on_period # Load a version 1 proc, and verify it is upgraded to version 2
expect on_lparen UNK on_lbracket on_symbeg foo on_rbracket on_rparen on_period to eq on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl on_ignored_nl expect on_lparen # Verify the config result
expect on_lparen UNK on_rparen on_period to eq on_lparen on_int on_rparen on_nl end on_nl end on_nl on_ignored_nl it on_tstring_beg on_tstring_content on_tstring_end # Verify the count is only one
expect on_lparen UNK on_lbracket on_symbeg foo on_rbracket on_rparen on_period to eq on_lparen on_lbracket on_tstring_beg on_tstring_content on_tstring_end on_rbracket on_rparen on_nl expect # Verify the config result
file on_op UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl on_int on_period UNK on_lbrace instance on_period set on_lparen on_symbeg file on_comma # We test both setting a file multiple times as well as multiple # loads, since both should not cache the data.
