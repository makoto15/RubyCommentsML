on_ivar on_op on_ivar on_period ssh_info on_nl on_ignored_nl UNK on_nl UNK on_nl UNK on_nl on_ignored_nl UNK if config on_period UNK on_nl # At this stage, the SSH access is guaranteed to be ready
UNK on_nl on_ignored_nl if on_op on_ivar on_op config on_period UNK on_period UNK on_op config on_period UNK on_period UNK on_period UNK # This step will also fetch the Ansible version data into related instance variables
if on_op on_ivar on_op config on_period UNK on_period UNK on_op config on_period UNK on_period UNK on_period UNK on_op on_symbeg UNK # Skip this check when not required, nor possible
on_ivar on_op on_tstring_beg on_tstring_content on_tstring_end on_nl on_ignored_nl on_ivar on_op on_tstring_beg on_tstring_content on_tstring_end on_nl on_ignored_nl if on_op config on_period UNK on_nl # Connect with native OpenSSH client # Other modes (e.g. paramiko) are not officially supported, # but can be enabled via raw_arguments option.
on_ivar on_op on_tstring_beg on_tstring_content on_tstring_end on_nl on_ignored_nl if on_op config on_period UNK on_nl on_ivar on_op on_tstring_beg on_tstring_content on_embexpr_beg on_ivar on_lbracket # Increase the SSH connection timeout, as the Ansible default value (10 seconds) # is a bit demanding for some overloaded developer boxes. This is particularly # helpful when additional virtual networks are configured, as their availability # is not controlled during vagrant boot process.
on_ivar on_op on_tstring_beg on_tstring_content on_embexpr_beg on_ivar on_lbracket on_symbeg UNK on_rbracket on_embexpr_end on_tstring_end on_nl UNK config on_period inventory_path on_nl on_ivar on_op # Pass the vagrant ssh username as Ansible default remote user, because # the ansible_ssh_user/ansible_user parameter won't be added to the auto-generated inventory.
on_ivar on_op on_tstring_beg on_tstring_content on_embexpr_beg on_ivar on_lbracket on_symbeg UNK on_rbracket on_embexpr_end on_tstring_content on_embexpr_beg on_ivar on_lbracket on_symbeg UNK on_rbracket on_embexpr_end on_tstring_content # Using an extra variable is the only way to ensure that the Ansible remote user # is overridden (as the ansible inventory is not under vagrant control)
on_ivar on_lbracket on_tstring_beg on_tstring_content on_tstring_end on_rbracket on_op on_tstring_beg on_embexpr_beg config on_period UNK on_embexpr_end on_tstring_end on_nl on_ignored_nl on_ivar on_lbracket on_tstring_beg on_tstring_content # Some Ansible options must be passed as environment variables, # as there is no equivalent command line arguments
on_ivar on_lbracket on_tstring_beg on_tstring_content on_tstring_end on_rbracket on_op UNK UNK UNK on_period UNK on_nl end on_nl on_ignored_nl def UNK on_lparen command # ANSIBLE_SSH_ARGS is required for Multiple SSH keys, SSH forwarding and custom SSH settings
on_label on_lbracket on_symbeg UNK on_comma on_symbeg UNK on_rbracket on_comma on_ignored_nl on_label on_ivar on_period env on_period UNK on_period UNK on_nl UNK # Write stdout and stderr data, since it's the regular Ansible output
command on_op on_lbracket config on_period UNK on_rbracket on_op on_ivar on_nl on_ignored_nl command on_op config on_period UNK if config on_period UNK # Assemble the full ansible-playbook command
command on_op config on_period UNK if config on_period UNK on_nl on_ignored_nl command on_op config on_period UNK on_nl command on_op command # Add the raw arguments at the end, to give them the highest precedence
on_label on_lbracket on_symbeg UNK on_comma on_symbeg UNK on_rbracket on_comma on_ignored_nl on_label on_ivar on_period env on_period UNK on_period UNK on_nl UNK # Write stdout and stderr data, since it's the regular Ansible output
inventory_tmpfile on_op on_const on_period new on_lparen on_tstring_beg on_tstring_content on_tstring_end on_comma inventory_path on_rparen on_nl inventory_tmpfile on_period UNK on_lparen UNK on_rparen on_nl # ansible dir inventory will ignore files starting with '.'
UNK on_op m on_period ssh_info on_nl UNK on_op UNK on_lparen m on_period name on_rparen on_nl if m on_period config on_period # Call only once the SSH and WinRM info computation # Note that machines configured with WinRM communicator, also have a "partial" ssh_info.
machines on_op UNK on_lparen m on_comma UNK on_rparen on_nl machines on_period UNK on_lparen UNK on_tstring_content UNK on_comma on_tstring_beg on_tstring_content on_embexpr_beg # can raise a WinRMNotReady exception...
machines on_op on_tstring_beg on_tstring_content on_embexpr_beg m on_period name on_embexpr_end on_tstring_content on_tstring_end on_nl end on_nl UNK on_const on_op on_const on_op on_const # Let a note about this missing machine
if on_ivar on_period UNK on_op on_symbeg UNK on_op machine on_period UNK on_period UNK on_nl UNK on_op machine on_period UNK on_period # Use an SSH ProxyCommand when using the Docker provider with the intermediate host
proxy_cmd on_op on_tstring_beg on_tstring_content on_tstring_end on_nl on_ignored_nl proxy_cmd on_op on_tstring_beg on_tstring_content on_tstring_end if on_ivar on_lbracket on_symbeg UNK on_rbracket on_nl on_ignored_nl # Use same options than plugins/providers/docker/communicator.rb # Note: this could be improved (DRY'ed) by sharing these settings.
end on_nl on_ignored_nl if on_ivar on_period ssh_info on_lbracket on_symbeg UNK on_rbracket on_nl proxy_cmd on_op on_ivar on_period ssh_info on_lbracket on_symbeg UNK # TODO ssh_options << "-o ProxyCommand=\"#{ proxy_cmd }\""
if on_ivar on_period ssh_info on_lbracket on_symbeg UNK on_rbracket on_nl proxy_cmd on_op on_ivar on_period ssh_info on_lbracket on_symbeg UNK on_rbracket on_nl ssh_options # Use an SSH ProxyCommand when corresponding Vagrant setting is defined
ssh_options on_op on_tstring_beg on_tstring_content on_tstring_end UNK config on_period UNK on_nl on_ignored_nl ssh_options on_op on_tstring_beg on_tstring_content on_tstring_end if on_op on_const on_op # Don't access user's known_hosts file, except when host_key_checking is enabled.
ssh_options on_op on_tstring_beg on_tstring_content on_tstring_end if on_op on_const on_op on_const on_op on_const on_period UNK on_op on_ivar on_lbracket on_symbeg UNK on_rbracket # Compare to lib/vagrant/util/ssh.rb
UNK on_op config on_period inventory_path on_op on_ivar on_lbracket on_symbeg UNK on_rbracket on_period UNK on_op on_int on_nl on_ivar on_lbracket on_symbeg UNK # Multiple Private Keys
ssh_options on_op on_tstring_beg on_tstring_content on_tstring_end if on_ivar on_lbracket on_symbeg UNK on_rbracket on_nl on_ignored_nl ssh_options on_period UNK on_lparen config on_period UNK # SSH Forwarding
ssh_options on_period UNK on_lparen config on_period UNK on_rparen if config on_period UNK on_nl on_ignored_nl UNK ssh_options on_period UNK on_nl ssh_options # Unchecked SSH Parameters
UNK ssh_options on_period UNK on_nl ssh_options on_op on_tstring_beg on_tstring_content on_tstring_end on_nl ssh_options on_op on_tstring_beg on_tstring_content on_tstring_end on_nl end on_nl on_ignored_nl # Re-enable ControlPersist Ansible defaults, # which are lost when ANSIBLE_SSH_ARGS is defined.
end on_nl on_ignored_nl ssh_options on_period UNK on_lparen on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl end on_nl on_ignored_nl def UNK on_lparen path on_comma # Intentionally keep ControlPath undefined to let ansible-playbook # automatically sets this option to Ansible default value
on_ignored_nl UNK on_op on_const on_period new on_lparen path on_rparen on_period UNK on_lparen on_ivar on_period env on_period UNK on_rparen on_nl if # Checks for the existence of given file (or directory) on the host system, # and error if it doesn't exist.
