root_path on_op on_ivar on_period UNK on_period root_path on_nl on_ivar on_op on_ivar on_period UNK on_lparen root_path on_rparen on_nl on_ignored_nl on_ivar on_op # Calculate the paths we're going to use based on the environment
on_ivar on_op on_lbracket on_rbracket on_nl on_ivar on_period UNK do on_op UNK on_comma UNK on_op on_ignored_nl key on_op on_const on_op on_const # Setup the module paths
if on_ivar on_period environment_path on_lbracket on_int on_rbracket on_period UNK on_op on_symbeg host on_nl UNK on_period UNK on_period UNK on_lparen on_ignored_nl # Share the environments directory with the guest
if on_ivar on_period manifests_path on_lbracket on_int on_rbracket on_period UNK on_op on_symbeg host on_nl UNK on_period UNK on_period UNK on_lparen on_ignored_nl # Share the manifests directory with the guest
on_ivar on_period UNK do on_op UNK on_comma UNK on_op on_ignored_nl UNK on_period UNK on_period UNK on_lparen UNK on_comma UNK on_comma # Share the module paths
UNK on_op on_const on_period join on_lparen environments_guest_path on_comma on_ivar on_period environment on_comma on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl if on_ivar on_period # Parse out the environment manifest path since puppet apply doesnt do that for us.
if on_ivar on_period UNK on_period UNK on_lparen on_symbeg UNK on_rparen on_nl on_ivar on_period UNK on_period UNK on_lparen on_symbeg UNK on_rparen # If the machine has a wait for reboot functionality, then # do that (primarily Windows)
if on_op on_ivar on_nl on_ivar on_op on_tstring_beg on_embexpr_beg environments_guest_path on_embexpr_end on_tstring_content on_embexpr_beg on_ivar on_period environment on_embexpr_end on_tstring_content on_tstring_end on_nl UNK # In environment mode we still need to specify a manifest file, if its not, use the one from env config if specified.
UNK on_op on_lbracket on_rbracket on_nl if on_ivar on_period manifests_path on_period UNK on_lparen on_const on_rparen on_op on_ivar on_period manifests_path on_lbracket on_int # Check that the shared folders are properly shared
if windows? on_nl UNK on_op on_tstring_beg on_tstring_content on_embexpr_beg config on_period temp_dir on_embexpr_end on_tstring_end on_nl comm_opts on_op on_lbrace on_label on_symbeg UNK # Make sure the temporary directory is properly set up
puppet_bin on_op on_tstring_beg on_tstring_content on_tstring_end on_nl UNK on_lparen puppet_bin on_rparen on_nl on_ignored_nl on_ivar on_op UNK on_nl if config on_period UNK # Verify Puppet is installed and run it
on_ivar on_op UNK on_nl if config on_period UNK on_nl UNK on_op on_const on_period UNK on_lparen config on_period UNK on_comma on_ignored_nl # Upload Hiera configuration if we have it
if config on_period UNK on_op on_op config on_period facter on_period UNK on_nl on_ivar on_op on_tstring_beg on_tstring_content on_tstring_end on_nl if windows? # Build up the structured custom facts if we have any # With structured facts on, we assume the config.facter is yaml.
key on_op on_const on_op on_const on_period UNK on_lparen config on_period manifests_path on_lbracket on_int on_rbracket on_rparen on_nl on_const on_period join on_lparen # The path is on the host, so point to where it is shared
config on_period manifests_path on_lbracket on_int on_rbracket on_nl end on_nl end on_nl on_ignored_nl def environments_guest_path on_nl if config on_period environment_path on_lbracket # The path is on the VM, so just point directly to it
on_const on_period join on_lparen config on_period temp_dir on_comma on_tstring_beg on_tstring_content on_tstring_end on_rparen on_nl else on_ignored_nl config on_period environment_path on_lbracket on_int # The path is on the host, so point to where it is shared
config on_period environment_path on_lbracket on_int on_rbracket on_nl end on_nl end on_nl on_ignored_nl def UNK on_lparen binary on_rparen on_ignored_nl UNK on_op # The path is on the VM, so just point directly to it
UNK on_op on_tstring_beg on_tstring_content on_embexpr_beg binary on_embexpr_end on_tstring_content on_tstring_end on_nl if windows? on_nl UNK on_op on_tstring_beg on_tstring_content on_embexpr_beg binary on_embexpr_end # Determine the command to use to test whether Puppet is available. # This is very platform dependent.
UNK on_op UNK on_nl on_ignored_nl UNK on_op windows? on_op on_tstring_beg on_tstring_content on_tstring_end on_op on_tstring_beg on_tstring_content on_tstring_end on_nl options on_op on_tstring_beg # Append the default module path
UNK on_op windows? on_op on_tstring_beg on_tstring_content on_tstring_end on_op on_tstring_beg on_tstring_content on_tstring_end on_nl options on_op on_tstring_beg on_tstring_content on_embexpr_beg UNK on_period join # Add the command line switch to add the module path
facter on_op UNK on_nl if on_op config on_period UNK on_op on_op config on_period facter on_period UNK on_nl UNK on_op on_lbracket # Build up the custom facts if we have any
if on_op config on_period UNK on_op on_op config on_period facter on_period UNK on_nl UNK on_op on_lbracket on_rbracket on_nl config on_period # Build up the (non-structured) custom facts if we have any
if windows? on_nl UNK on_period UNK on_lbrace on_op UNK on_op on_tstring_beg on_tstring_content on_embexpr_beg UNK on_embexpr_end on_tstring_content on_tstring_end on_rbrace on_nl end # If we're on Windows, we need to use the PowerShell style
